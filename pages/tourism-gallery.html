<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourism Gallery - IBADAT</title>
    <link rel="icon" href="../images/favicon.png" type="image/png">
    <link rel="stylesheet" href="../css/style.css?v=17">
    <!-- Preload images with priority handling -->
    <link rel="preload" href="../tourism_imgs/p1-sm.webp" as="image" type="image/webp">
    <link rel="preload" href="../tourism_imgs/p2-sm.webp" as="image" type="image/webp">
    <link rel="preload" href="../tourism_imgs/p3-sm.webp" as="image" type="image/webp">
    <link rel="preload" href="../tourism_imgs/p4-sm.webp" as="image" type="image/webp">
    <link rel="preload" href="../tourism_imgs/p5-sm.webp" as="image" type="image/webp">
    <link rel="preload" href="../tourism_imgs/p6-sm.webp" as="image" type="image/webp">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="../images/logo.webp" alt="IBADAT Logo" class="logo-img">
                <div>
                    <h1>IBADAT</h1>
                    <p>Umrah & Zayarat Group</p>
                </div>
            </div>

            <div class="menu-toggle" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul id="navMenu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../index.html#about">About Us</a></li>
                <li><a href="../index.html#services">Services</a></li>
                <li><a href="umrah-packages.html" class="blink">Packages</a></li>
                <li><a href="tourism-gallery.html" class="active">Tourism Gallery</a></li>
                <li><a href="../index.html#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main class="tourism-gallery-page">
        <section class="gallery-hero">
            <div class="container">
                <h2>Tourism Gallery</h2>
                <p>Explore beautiful destinations and moments captured by our travelers</p>
            </div>
        </section>

        <section class="gallery-section">
            <div class="gallery-masonry" id="gallery">
                <!-- Responsive images with WebP format and lazy loading for consistent grid -->
                <a class="gallery-item" href="../tourism_imgs/p2.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p2-sm.webp 300w, ../tourism_imgs/p2-md.webp 600w, ../tourism_imgs/p2.webp 1000w" type="image/webp">
                        <img src="../tourism_imgs/p2-sm.jpg" alt="Tourism 2" loading="eager" decoding="async" fetchpriority="high" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw" onerror="this.onerror=null;this.src='../images/logo.webp';this.classList.add('is-loaded');">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p3.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p3-sm.webp 300w, ../tourism_imgs/p3-md.webp 600w, ../tourism_imgs/p3.webp 1000w" type="image/webp">
                        <img src="../tourism_imgs/p3-sm.jpg" alt="Tourism 3" loading="eager" decoding="async" fetchpriority="high" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw" onerror="this.onerror=null;this.src='../images/logo.webp';this.classList.add('is-loaded');">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p4.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p4-sm.webp 300w, ../tourism_imgs/p4-md.webp 600w, ../tourism_imgs/p4.webp 1000w" type="image/webp">
                        <img src="../tourism_imgs/p4-sm.jpg" alt="Tourism 4" loading="eager" decoding="async" fetchpriority="high" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw" onerror="this.onerror=null;this.src='../images/logo.webp';this.classList.add('is-loaded');">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p5.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p5-sm.webp 300w, ../tourism_imgs/p5-md.webp 600w, ../tourism_imgs/p5.webp 1000w" type="image/webp">
                        <img src="../tourism_imgs/p5-sm.jpg" alt="Tourism 5" loading="eager" decoding="async" fetchpriority="high" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw" onerror="this.onerror=null;this.src='../images/logo.webp';this.classList.add('is-loaded');">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p6.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p6-sm.webp 300w, ../tourism_imgs/p6-md.webp 600w, ../tourism_imgs/p6.webp 1000w" type="image/webp">
                        <img src="../tourism_imgs/p6-sm.jpg" alt="Tourism 6" loading="eager" decoding="async" fetchpriority="high" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw" onerror="this.onerror=null;this.src='../images/logo.webp';this.classList.add('is-loaded');">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p7.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p7-sm.webp 300w, ../tourism_imgs/p7-md.webp 600w, ../tourism_imgs/p7.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p7-sm.jpg" alt="Tourism 7" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p8.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p8-sm.webp 300w, ../tourism_imgs/p8-md.webp 600w, ../tourism_imgs/p8.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p8-sm.jpg" alt="Tourism 8" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p9.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p9-sm.webp 300w, ../tourism_imgs/p9-md.webp 600w, ../tourism_imgs/p9.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p9-sm.jpg" alt="Tourism 9" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p10.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p10-sm.webp 300w, ../tourism_imgs/p10-md.webp 600w, ../tourism_imgs/p10.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p10-sm.jpg" alt="Tourism 10" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p11.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p11-sm.webp 300w, ../tourism_imgs/p11-md.webp 600w, ../tourism_imgs/p11.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p11-sm.jpg" alt="Tourism 11" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p12.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p12-sm.webp 300w, ../tourism_imgs/p12-md.webp 600w, ../tourism_imgs/p12.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p12-sm.jpg" alt="Tourism 12" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p13.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p13-sm.webp 300w, ../tourism_imgs/p13-md.webp 600w, ../tourism_imgs/p13.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p13-sm.jpg" alt="Tourism 13" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p14.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p14-sm.webp 300w, ../tourism_imgs/p14-md.webp 600w, ../tourism_imgs/p14.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p14-sm.jpg" alt="Tourism 14" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p15.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p15-sm.webp 300w, ../tourism_imgs/p15-md.webp 600w, ../tourism_imgs/p15.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p15-sm.jpg" alt="Tourism 15" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p16.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p16-sm.webp 300w, ../tourism_imgs/p16-md.webp 600w, ../tourism_imgs/p16.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p16-sm.jpg" alt="Tourism 16" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
                <a class="gallery-item" href="../tourism_imgs/p17.jpg" data-size="regular">
                    <picture>
                        <source srcset="../tourism_imgs/p17-sm.webp 300w, ../tourism_imgs/p17-md.webp 600w, ../tourism_imgs/p17.webp 1000w" type="image/webp">
                        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==" data-src="../tourism_imgs/p17-sm.jpg" alt="Tourism 17" loading="lazy" decoding="async" class="lazy" sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw">
                    </picture>
                    <div class="gallery-overlay"><div class="gallery-overlay-content"><div class="gallery-overlay-icon"></div></div></div>
                </a>
            </div>
        </section>

        <!-- Lightbox modal -->
        <div id="lightbox" class="lightbox" style="display:none;">
            <button class="lightbox-close" aria-label="Close">Ã—</button>
            <button class="lightbox-prev" aria-label="Previous">&#10094;</button>
            <img class="lightbox-img" src="" alt="">
            <button class="lightbox-next" aria-label="Next">&#10095;</button>
        </div>
    </main>

    <script>
    (function(){
        const container = document.querySelector('.gallery-masonry');
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = lightbox.querySelector('.lightbox-img');
        const closeBtn = lightbox.querySelector('.lightbox-close');
        const prevBtn = lightbox.querySelector('.lightbox-prev');
        const nextBtn = lightbox.querySelector('.lightbox-next');
        let io = null, resizeTimer = null, currentIndex = -1;

        async function buildMosaic(){
            if(!container) return;
            const items = Array.from(container.querySelectorAll('.gallery-item'));
            
            initLazyObserver();
            markEagerLoaded();
        }

        function initLazyObserver(){
            const lazyImgs = Array.from(document.querySelectorAll('.gallery-item img.lazy'));
            if(io){ lazyImgs.forEach(img => io.observe(img)); return; }
            if('IntersectionObserver' in window){
                io = new IntersectionObserver((entries, obs) => {
                    entries.forEach(entry => {
                        if(entry.isIntersecting){
                            const img = entry.target;
                            const picture = img.closest('picture');
                            if(img.dataset.src) {
                                // Update source elements if they exist
                                if(picture) {
                                    const sources = picture.querySelectorAll('source');
                                    sources.forEach(src => {
                                        const srcset = src.getAttribute('srcset');
                                        if(srcset) {
                                            const newSrcset = srcset.replace(/p\d+-/g, (match) => {
                                                const num = img.alt.replace(/\D/g, '');
                                                return `p${num}-`;
                                            });
                                            src.setAttribute('srcset', newSrcset);
                                        }
                                    });
                                }
                                img.src = img.dataset.src;
                            }
                            img.onload = () => img.classList.add('is-loaded');
                            img.onerror = () => { img.src = '../images/logo.webp'; img.classList.add('is-loaded'); };
                            obs.unobserve(img);
                        }
                    });
                }, { rootMargin: '1000px' });
                lazyImgs.forEach(img => io.observe(img));
            } else {
                lazyImgs.forEach(img => { if(img.dataset.src) img.src = img.dataset.src; img.onload = () => img.classList.add('is-loaded'); img.onerror = () => { img.src = '../images/logo.webp'; img.classList.add('is-loaded'); }; });
            }
        }

        function markEagerLoaded(){
            document.querySelectorAll('.gallery-item img[loading="eager"]').forEach(img => {
                img.onerror = () => { img.src = '../images/logo.webp'; img.classList.add('is-loaded'); };
                if(img.complete) img.classList.add('is-loaded'); else img.onload = () => img.classList.add('is-loaded');
            });
        }

        function showLightbox(index){
            const items = Array.from(document.querySelectorAll('.gallery-item'));
            currentIndex = (index + items.length) % items.length;
            const href = items[currentIndex].href;
            lightboxImg.src = href;
            lightbox.style.display = 'flex';
            closeBtn.focus();
            const next = (currentIndex + 1) % items.length;
            const l = document.createElement('link'); l.rel = 'preload'; l.as = 'image'; l.href = items[next].href; document.head.appendChild(l);
        }
        function hideLightbox(){ lightbox.style.display = 'none'; lightboxImg.src = ''; currentIndex = -1; }
        function showNext(){ showLightbox(currentIndex + 1); }
        function showPrev(){ showLightbox(currentIndex - 1); }

        document.addEventListener('click', function(e){
            const link = e.target.closest('.gallery-item');
            if(link){ e.preventDefault(); const items = Array.from(document.querySelectorAll('.gallery-item')); showLightbox(items.indexOf(link)); return; }
            if(e.target === lightbox || e.target === closeBtn) hideLightbox();
            if(e.target === nextBtn) showNext();
            if(e.target === prevBtn) showPrev();
        });

        document.addEventListener('keydown', function(e){
            if(lightbox.style.display !== 'flex') return;
            if(e.key === 'Escape') hideLightbox();
            if(e.key === 'ArrowRight') showNext();
            if(e.key === 'ArrowLeft') showPrev();
        });

        window.addEventListener('resize', () => { clearTimeout(resizeTimer); resizeTimer = setTimeout(buildMosaic, 180); });

        // Initial build
        buildMosaic();

    })();
    </script>

</body>
</html>
